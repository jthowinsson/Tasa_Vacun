---
title: "Modelaci√≥n de la Tasa de Vacunaci√≥n contra el COVID-19 en Colombia un an√°lisis de  Regresi√≥n Beta"
format:
  html:
    theme: flatly           # Puedes cambiar por: cerulean, cosmo, journal, lumen, united
    highlight: tango        # Estilo de resaltado de c√≥digo
    toc: true               # Muestra tabla de contenido
    toc-depth: 3            # Profundidad m√°xima del TOC
    toc-location: left      # Posici√≥n del TOC flotante
    toc_float: true         # Tabla de contenido flotante
    number-sections: true   # Numeraci√≥n de secciones
    df-print: paged         # Tablas paginadas si son largas
    fig-cap-location: bottom # Para leyendas bajo gr√°ficos
    code-fold: true         # Opci√≥n para plegar c√≥digo
    keep-md: true           # Guarda el markdown intermedio
    bibliography: referencias.bib
    csl: apa.csl            # si est√°s usando estilo APA
    citation: true
---

2025-05-16

```{r}
#| message: false
#| warning: false
#| label: setup
#| include: false

knitr::opts_chunk$set(
  echo = TRUE,
  fig.width = 7,
  fig.height = 5,
  fig.align = "center"
)

```




::: {style="text-align: left;"}
**Zamora, T. Jes√∫s D**[^1]  
[thowinssonj@uninorte.edu.co](mailto:thowinssonj@uninorte.edu.co)  

**Melendez, A. Gregory J**[^2]  
[gjmelendez@uninorte.edu.co](mailto:gjmelendez@uninorte.edu.co)  
:::

::: {style="text-align: center;"}
Barranquilla-Colombia.
:::

[^1]: *Jes√∫s David Zamora Thowinsson*. Economista y Administrador P√∫blico, Especialista en Estad√≠stica Aplicada, Candidato a Mag√≠ster Scientiarum en Gerencia Empresarial, Mag√≠ster en Estad√≠stica Aplicada Universidad del Norte.

[^2]: *Gregory Jes√∫s Melendez Alvarez*. Economista, Especialista en Estad√≠stica Aplicada, Mag√≠ster en Estad√≠stica Aplicada Universidad del Norte.


```{=html}
<iframe src="globo.html" width="80%" height="300" style="border:none;"></iframe>
```


```{=html}
<style>
  #TOC::before {
    content: "";
    display: block;
    width: 100%;
    background-image: url('Imagen_portada.png');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    margin-bottom: 20px;
    border-radius: 10px;
    height: 250px; /* Ajusta la altura seg√∫n tu imagen */
  }
</style>
```

::: {#toc-imagen-container}
<img src="Portada2.jpg" alt="Ejercicios de Practicas" id="imagen-toc"/>
:::

::: {style="text-align: left;"}
#  Resumen
::: 

::: {style="text-align: justify;"}
La tasa de vacunaci√≥n es un indicador clave en el √°mbito de la salud p√∫blica debido a su impacto directo en la prevenci√≥n de enfermedades. Su importancia radica en que no solo protege a los individuos vacunados, sino que tambi√©n genera un efecto positivo a nivel comunitario, contribuyendo al control y erradicaci√≥n de diversas enfermedades infecciosas. Una alta tasa de vacunaci√≥n reduce significativamente la carga sobre los sistemas de salud, al disminuir la prevalencia de enfermedades transmisibles, lo que a su vez disminuye los costos asociados a su tratamiento y hospitalizaci√≥n. Adem√°s, mejora la calidad de vida de las personas al prevenir complicaciones graves y potenciales muertes prematuras. La cobertura universal de vacunas tambi√©n favorece la construcci√≥n de "inmunidad colectiva", protegiendo a los individuos m√°s vulnerables que no pueden recibir la vacuna debido a condiciones m√©dicas. La vacunaci√≥n, por tanto, juega un papel crucial en el logro de los objetivos globales de salud p√∫blica establecidos por organismos internacionales, como la Organizaci√≥n Mundial de la Salud (OMS). En resumen, la tasa de vacunaci√≥n es una herramienta fundamental para la promoci√≥n de la salud, la sostenibilidad de los sistemas sanitarios y la mejora del bienestar de las comunidades a nivel global.
:::

# Introducci√≥n

::: {style="text-align: justify;"}
La tasa de vacunaci√≥n es crucial por diversas razones que impactan tanto la salud p√∫blica como la econom√≠a y el bienestar social. A continuaci√≥n, te proporciono una estructura detallada sobre su importancia:

1. Prevenci√≥n de Enfermedades Infecciosas
La tasa de vacunaci√≥n es un factor clave en la prevenci√≥n de enfermedades infecciosas. Al aumentar la cobertura de vacunaci√≥n, se reduce la propagaci√≥n de virus y bacterias, lo que ayuda a prevenir brotes y epidemias. Esto es especialmente importante para enfermedades como la poliomielitis, el sarampi√≥n, la rub√©ola, y m√°s recientemente, el COVID-19.

Inmunidad colectiva: Cuando un porcentaje suficiente de la poblaci√≥n est√° vacunada, se crea lo que se conoce como inmunidad colectiva o de reba√±o. Esto significa que incluso aquellos que no pueden recibir la vacuna, como personas con condiciones de salud preexistentes o al√©rgicas, est√°n protegidos indirectamente debido a la baja circulaci√≥n del pat√≥geno.

2. Reducci√≥n de la Mortalidad y Morbilidad
Las vacunas han sido responsables de la reducci√≥n significativa en las tasas de mortalidad y morbilidad de diversas enfermedades. La tasa de vacunaci√≥n alta est√° directamente relacionada con una menor cantidad de muertes y complicaciones derivadas de enfermedades prevenibles por vacunaci√≥n.

Reducci√≥n de hospitalizaciones: Las personas vacunadas son menos propensas a desarrollar formas graves de enfermedades, lo que reduce la presi√≥n sobre los sistemas de salud y los hospitales, especialmente durante brotes o pandemias.

3. Costos en Salud P√∫blica
Una alta tasa de vacunaci√≥n no solo mejora la salud p√∫blica, sino que tambi√©n reduce los costos relacionados con la atenci√≥n m√©dica. Esto incluye el tratamiento de enfermedades graves, hospitalizaciones, y los costos de los programas de salud p√∫blica que se necesitar√≠an para controlar brotes. Las vacunas, al ser m√°s baratas que el tratamiento de enfermedades graves, representan una inversi√≥n econ√≥mica en la salud a largo plazo.

4. Eliminaci√≥n de Enfermedades y Erradicaci√≥n de Pat√≥genos
En algunos casos, una alta tasa de vacunaci√≥n ha llevado a la erradicaci√≥n de enfermedades. El ejemplo m√°s destacado es la erradicaci√≥n de la viruela, y m√°s recientemente, la dr√°stica reducci√≥n de casos de polio en muchas partes del mundo. La eliminaci√≥n de pat√≥genos por medio de la vacunaci√≥n no solo salva vidas, sino que tambi√©n reduce la carga en los sistemas de salud a nivel global.

5. Protecci√≥n a Poblaciones Vulnerables
Al mantener altas tasas de vacunaci√≥n, se protege especialmente a las poblaciones vulnerables, como los ni√±os, los ancianos, y las personas con sistemas inmunitarios comprometidos. Estas personas son m√°s propensas a desarrollar enfermedades graves y, por lo tanto, se benefician directamente de una alta tasa de vacunaci√≥n en la comunidad.

6. Fomentar la Confianza en las Vacunas
Una alta tasa de vacunaci√≥n tambi√©n ayuda a fomentar la confianza en los programas de vacunaci√≥n y en las pol√≠ticas de salud p√∫blica. Cuando las personas ven que las vacunas son efectivas y seguras, se sienten m√°s inclinadas a vacunarse, lo que mejora a√∫n m√°s las tasas de cobertura.

7. Impacto Global en la Salud
A nivel global, las altas tasas de vacunaci√≥n son esenciales para controlar enfermedades infecciosas transnacionales y evitar pandemias. Programas internacionales como los promovidos por la Organizaci√≥n Mundial de la Salud (OMS) trabajan para aumentar la cobertura de vacunaci√≥n en todo el mundo, especialmente en pa√≠ses de ingresos bajos y medios.
:::

# Metodologia

::: {style="text-align: justify;"}
En este documento se explicar√° c√≥mo funciona el modelo beta en el contexto de un modelo lineal generalizado (GLM), utilizando la tasa de vacunaci√≥n como ejemplo para una variable dependiente. Se detallar√° la media esperada $(ùúá)$ y su c√°lculo utilizando la funci√≥n de enlace logit.

### Supuestos del Modelo

La variable dependiente $(y_i)$ (tasa de vacunaci√≥n) est√° en el intervalo $(0, 1)$.

$$
y_i \sim \text{Beta}(\mu_i, \phi)
$$
Donde:

-   $(\mu_i \in (0, 1))$: es la media de la tasa de vacunaci√≥n para el individuo o grupo (i).
-   $(\phi > 0)$: es el par√°metro de precisi√≥n (similar a una inversa de la varianza).

### Modelo Lineal sobre la Media (con Funci√≥n de Enlace Logit)

Usamos la funci√≥n de enlace logit para mapear la media $(\mu_i \in (0, 1))$ al espacio real:

$$
\text{logit}(\mu_i) = \log\left(\frac{\mu_i}{1 - \mu_i}\right) = \eta_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i}
$$
Entonces:

$$
\mu_i = \frac{1}{1 + e^{-(\beta_0 + \beta_1 x_{1i} + \dots + \beta_4 x_{4i})}}
$$

### ¬øQu√© Representa Cada Cosa?

-   $(y_i)$: tasa de vacunaci√≥n observada.
-   $(\mu_i)$: valor esperado de la tasa de vacunaci√≥n dado $(x_1, x_2, x_3, x_4)$.
-   $(\beta_0, \dots, \beta_4)$: coeficientes a estimar.
-   $(x_{1i}, \dots, x_{4i})$: variables independientes (por ejemplo: edad promedio, nivel educativo, ingresos, acceso a centros de salud).

## Modelo Beta: Parametrizaci√≥n
 
En una regresi√≥n beta, se asume que cada $y_i \in (0,1)$ sigue una distribuci√≥n beta con par√°metros:
 
$$
y_i \sim \text{Beta}(\mu_i \phi, (1 - \mu_i)\phi)
$$
 
Donde:
 
- La **media** es:  
  $$
  \mathbb{E}[y_i] = \mu_i
  $$
 
- La **varianza** es:  
  $$
  \text{Var}(y_i) = \frac{\mu_i(1 - \mu_i)}{1 + \phi}
  $$
 
### Funci√≥n de Verosimilitud
 
La funci√≥n de densidad de una variable beta con parametrizaci√≥n en t√©rminos de $\mu_i$ y $\phi$ es:
 
$$
f(y_i; \mu_i, \phi) = \frac{\Gamma(\phi)}{\Gamma(\mu_i \phi)\Gamma((1 - \mu_i)\phi)} y_i^{\mu_i\phi - 1} (1 - y_i)^{(1 - \mu_i)\phi - 1}
$$
 
La funci√≥n de verosimilitud conjunta para todos los $i$ es el producto de estas densidades, y su log-verosimilitud es:
 
$$
\ell(\mu, \phi) = \sum_{i=1}^n \left[ \log \Gamma(\phi) - \log \Gamma(\mu_i \phi) - \log \Gamma((1 - \mu_i)\phi) + (\mu_i \phi - 1)\log y_i + ((1 - \mu_i)\phi - 1)\log (1 - y_i) \right]
$$
 
 
### Estimaci√≥n de $\phi$
 
Para estimar $\phi$, se toma la derivada de la log-verosimilitud con respecto a $\phi$, y se iguala a cero:
 
$$
\frac{\partial \ell}{\partial \phi} = 0
$$
 
Esto implica derivadas de la funci√≥n gamma, que se expresan mediante la **funci√≥n digamma**:
 
$$
\psi(x) = \frac{d}{dx} \log \Gamma(x)
$$
 
Entonces se obtiene la siguiente ecuaci√≥n:
 
$$
\sum_{i=1}^n \left[ \psi(\phi) - \mu_i \psi(\mu_i \phi) - (1 - \mu_i) \psi((1 - \mu_i)\phi) + \mu_i \log y_i + (1 - \mu_i) \log(1 - y_i) \right] = 0
$$

 
### Conclusi√≥n
 
- No puedes aislar $\phi$ en una f√≥rmula simple.
- Depende de todos los valores $y_i$ y $\mu_i$.
- Involucra funciones especiales (gamma, digamma).
- Se estima resolviendo la ecuaci√≥n num√©ricamente mediante algoritmos como **Newton-Raphson** o **BFGS**.

## Varianza del Modelo

La varianza de $(y_i)$ en un modelo Beta no es constante (como en regresi√≥n lineal):

$$
\text{Var}(y_i) = \frac{\mu_i (1 - \mu_i)}{1 + \phi}
$$

Entonces, cuanto mayor es $(\phi)$, menor es la varianza alrededor de $(\mu_i)$.

### ¬øQu√© significa que $(\phi > 0)$?

En el modelo Beta, el par√°metro $(\phi)$ (llamado precisi√≥n o dispersi√≥n inversa) siempre es positivo:

$$
\phi > 0
$$
-   No puede ser cero.
-   No puede ser negativo.

### ¬øC√≥mo afecta a la forma de la distribuci√≥n?

La varianza de una variable Beta se calcula de la siguiente manera:

$$
\text{Var}(y) = \frac{\mu (1 - \mu)}{1 + \phi}
$$

### Valor de $(\phi)$ y su impacto en la varianza:

| **Valor de $(\phi)$ | **¬øQu√© pasa con la varianza?** | **¬øQu√© significa?** |
|------------------------|-----------------------------|--------------------|
| Muy bajo (ej. 1) | Varianza alta | Alta dispersi√≥n: los valores de  $(y)$ est√°n bien esparcidos entre 0 y 1. |
| Moderado (ej. 10) | Varianza media | Los valores de $(y)$ comienzan a concentrarse m√°s alrededor de $(\mu)$. |
| Alto (ej. 100 o m√°s) | Varianza baja | Alta precisi√≥n: casi todos los valores de $(y)$ est√°n muy cerca de $(\mu)$. |

### Explicaci√≥n de la tabla:

-   $\phi$ muy bajo: Esto implica que hay una alta dispersi√≥n en los valores de la tasa de vacunaci√≥n, lo que significa que los valores de yyy (tasa de vacunaci√≥n) est√°n m√°s distribuidos a lo largo del intervalo (0,1)(0, 1)(0,1).

    $\phi$ moderado: A medida que $\phi$ aumenta, los valores de yyy tienden a concentrarse m√°s alrededor de la media Œº\muŒº, reduciendo la dispersi√≥n.

    $\phi$ alto: Un $\phi$ alto indica una alta precisi√≥n, es decir, la mayor√≠a de los valores de yyy est√°n muy cerca de la media Œº\muŒº.

### Interpretaci√≥n de $(\phi)$ en el Modelo Beta

-   $(\phi)$ peque√±o (por ejemplo, $(\phi \approx 1))$
    Los datos son m√°s dispersos alrededor de la media. Las observaciones tienen mayor variabilidad.

-   $(\phi)$ moderado (por ejemplo, $(\phi \approx 5 \text{ o } 10)$
    Hay una dispersi√≥n moderada. Los datos no est√°n excesivamente dispersos, pero tampoco est√°n demasiado concentrados alrededor de la media.

-   $(\phi)$ grande (por ejemplo, $(\phi > 10)$
    Los datos son m√°s concentrados alrededor de la media. Las observaciones est√°n muy cerca de $(\mu)$, lo que indica menos variabilidad.
:::

# Resultados

```{r}
#| message: false
#| warning: false

library(readxl)

# Definir la ruta al archivo Excel
ruta_archivo <- "/Users/instructorzamora/Documents/3_Maestria_Estadistica_UNINORTE/3_Tercer_Semestre/Advanced_Statistics/Tasa_Vacun/owid-covid-data.xlsx"

# Cargar el archivo Excel en un data frame
datos <- read_excel(ruta_archivo)

# Verificar las primeras filas del dataset
head(datos)
colnames(datos)
```

```{r}
#| message: false
#| warning: false
# Crear un data frame con los nombres de las variables y sus descripciones
variables <- data.frame(
  Variable = c("iso_code", "continent", "location", "date", "total_cases", 
               "new_cases", "new_cases_smoothed", "total_deaths", "new_deaths", 
               "new_deaths_smoothed", "total_cases_per_million", "new_cases_per_million", 
               "new_cases_smoothed_per_million", "total_deaths_per_million", 
               "new_deaths_per_million", "new_deaths_smoothed_per_million", 
               "reproduction_rate", "icu_patients", "icu_patients_per_million", 
               "hosp_patients", "hosp_patients_per_million", "weekly_icu_admissions", 
               "weekly_icu_admissions_per_million", "weekly_hosp_admissions", 
               "weekly_hosp_admissions_per_million", "total_tests", "new_tests", 
               "total_tests_per_thousand", "new_tests_per_thousand", 
               "new_tests_smoothed", "new_tests_smoothed_per_thousand", "positive_rate", 
               "tests_per_case", "tests_units", "total_vaccinations", "people_vaccinated", 
               "people_fully_vaccinated", "total_boosters", "new_vaccinations", 
               "new_vaccinations_smoothed", "total_vaccinations_per_hundred", 
               "people_vaccinated_per_hundred", "people_fully_vaccinated_per_hundred", 
               "total_boosters_per_hundred", "new_vaccinations_smoothed_per_million", 
               "new_people_vaccinated_smoothed", "new_people_vaccinated_smoothed_per_hundred", 
               "stringency_index", "population_density", "median_age", "aged_65_older", 
               "aged_70_older", "gdp_per_capita", "extreme_poverty", "cardiovasc_death_rate", 
               "diabetes_prevalence", "female_smokers", "male_smokers", "handwashing_facilities", 
               "hospital_beds_per_thousand", "life_expectancy", "human_development_index", 
               "population", "excess_mortality_cumulative_absolute", 
               "excess_mortality_cumulative", "excess_mortality", 
               "excess_mortality_cumulative_per_million"),
  Descripci√≥n = c("C√≥digo del pa√≠s o regi√≥n seg√∫n el est√°ndar ISO", 
                  "Continente al que pertenece el pa√≠s o regi√≥n", 
                  "Nombre del pa√≠s o regi√≥n", 
                  "Fecha de la observaci√≥n", 
                  "Total de casos confirmados de COVID-19 en el pa√≠s o regi√≥n", 
                  "Nuevos casos confirmados de COVID-19 en el d√≠a", 
                  "Promedio de nuevos casos confirmados de COVID-19 suavizados por 7 d√≠as", 
                  "Total de muertes confirmadas por COVID-19 en el pa√≠s o regi√≥n", 
                  "Nuevas muertes confirmadas por COVID-19 en el d√≠a", 
                  "Promedio de nuevas muertes confirmadas de COVID-19 suavizadas por 7 d√≠as", 
                  "Total de casos por mill√≥n de habitantes", 
                  "Nuevos casos por mill√≥n de habitantes", 
                  "Nuevos casos suavizados por mill√≥n de habitantes", 
                  "Total de muertes por mill√≥n de habitantes", 
                  "Nuevas muertes por mill√≥n de habitantes", 
                  "Nuevas muertes suavizadas por mill√≥n de habitantes", 
                  "Tasa de reproducci√≥n del virus", 
                  "N√∫mero de pacientes en unidades de cuidados intensivos (UCI)", 
                  "N√∫mero de pacientes en UCI por mill√≥n de habitantes", 
                  "N√∫mero de pacientes hospitalizados", 
                  "N√∫mero de pacientes hospitalizados por mill√≥n de habitantes", 
                  "Nuevas admisiones a UCI por semana", 
                  "Nuevas admisiones a UCI por mill√≥n de habitantes por semana", 
                  "Nuevas admisiones a hospitales por semana", 
                  "Nuevas admisiones a hospitales por mill√≥n de habitantes por semana", 
                  "Total de pruebas realizadas para detectar COVID-19", 
                  "Nuevas pruebas realizadas en el d√≠a", 
                  "Total de pruebas por cada mil habitantes", 
                  "Nuevas pruebas por cada mil habitantes", 
                  "Nuevas pruebas suavizadas por 7 d√≠as", 
                  "Nuevas pruebas suavizadas por mil habitantes", 
                  "Tasa de resultados positivos entre las pruebas realizadas", 
                  "N√∫mero de pruebas realizadas por cada caso confirmado", 
                  "Unidad de medida de las pruebas", 
                  "Total de personas vacunadas", 
                  "Total de personas que han recibido al menos una dosis de la vacuna", 
                  "Total de personas completamente vacunadas", 
                  "Total de dosis de refuerzo administradas", 
                  "Nuevas personas vacunadas en el d√≠a", 
                  "Nuevas personas vacunadas suavizadas por 7 d√≠as", 
                  "Total de vacunaciones por cada 100 personas", 
                  "Personas vacunadas por cada 100 personas", 
                  "Personas completamente vacunadas por cada 100 personas", 
                  "Dosis de refuerzo por cada 100 personas", 
                  "Nuevas vacunaciones suavizadas por mill√≥n de habitantes", 
                  "Nuevas personas vacunadas suavizadas por 7 d√≠as", 
                  "Nuevas personas vacunadas suavizadas por 100 personas", 
                  "√çndice de severidad de las medidas de restricci√≥n COVID-19", 
                  "Densidad de poblaci√≥n (habitantes por km¬≤)", 
                  "Edad media de la poblaci√≥n", 
                  "Porcentaje de la poblaci√≥n de 65 a√±os o m√°s", 
                  "Porcentaje de la poblaci√≥n de 70 a√±os o m√°s", 
                  "Producto Interno Bruto (PIB) per c√°pita", 
                  "Porcentaje de la poblaci√≥n que vive en pobreza extrema", 
                  "Tasa de mortalidad por enfermedades cardiovasculares", 
                  "Prevalencia de diabetes en la poblaci√≥n", 
                  "Porcentaje de mujeres que fuman", 
                  "Porcentaje de hombres que fuman", 
                  "Porcentaje de poblaci√≥n con acceso a instalaciones para lavarse las manos", 
                  "N√∫mero de camas de hospital por cada mil habitantes", 
                  "Esperanza de vida promedio en a√±os", 
                  "√çndice de desarrollo humano (IDH)", 
                  "Poblaci√≥n total del pa√≠s o regi√≥n", 
                  "Mortalidad excesiva acumulada en t√©rminos absolutos", 
                  "Mortalidad excesiva acumulada en t√©rminos relativos", 
                  "Mortalidad excesiva en el periodo", 
                  "Mortalidad excesiva acumulada por mill√≥n de habitantes")
)

# Mostrar la tabla con las variables y sus descripciones
knitr::kable(variables, caption = "Significado de las Variables")

```


```{r}
#| message: false
#| warning: false
#| label: tbl-clases-filtradas
#| tbl-cap: "Tipos de Variable con Filtro Interactivo por Clase"

# 1. Cargar la librer√≠a DT
library(DT)

# 2. Obtenemos las clases de cada variable en un vector
clases <- sapply(datos, class)

# 3. Convertimos el resultado en un data frame
tabla_clases <- data.frame(
  Variable = names(clases),
  Clase = unname(clases),
  row.names = NULL
)

# 4. Creamos la tabla interactiva con el filtro desplegable
datatable(
  tabla_clases,
  filter = 'top', # <-- ¬°Esta es la clave para los filtros!
  options = list(pageLength = 10)
)
```


# Las Variables Propuestas

::: {style="text-align: justify;"}
La selecci√≥n de variables es un paso cr√≠tico para modelar la tasa de vacunaci√≥n de manera efectiva. Proponemos una triada de indicadores que, en conjunto, ofrecen una visi√≥n integral de los factores que impulsan o limitan el √©xito de una campa√±a de inmunizaci√≥n. Estas variables son:
:::

1. stringency_index (√çndice de severidad de las medidas)
2. total_tests (Total de pruebas realizadas para detectar COVID-19)
3. total_deaths (Total de muertes confirmadas por COVID-19 en el pa√≠s o regi√≥n)

::: {style="text-align: justify;"}

1. `stringency_index` **(√çndice de Severidad de las Medidas)**: Esta variable es crucial porque act√∫a como un proxy directo de la respuesta gubernamental y las pol√≠ticas de salud p√∫blica. Un √≠ndice alto no solo refleja la implementaci√≥n de medidas como confinamientos o restricciones de movilidad, sino que tambi√©n indica la capacidad y voluntad del estado para intervenir en la crisis. Estas pol√≠ticas pueden influir directamente en la vacunaci√≥n a trav√©s de mandatos, campa√±as de concientizaci√≥n o, por el contrario, restringiendo el acceso si la log√≠stica se centra en otras √°reas. Por lo tanto, este √≠ndice captura el contexto normativo en el que se desarrolla la vacunaci√≥n.

2. `total_tests` **(Total de Pruebas Realizadas)**: M√°s que un simple conteo de pruebas, esta variable es un indicador fundamental de la capacidad y la infraestructura del sistema de salud. Un pa√≠s con la capacidad de realizar un alto volumen de pruebas demuestra tener la red log√≠stica, el personal y los sistemas de informaci√≥n necesarios para llevar a cabo otra operaci√≥n masiva de salud p√∫blica: la vacunaci√≥n. Refleja la visibilidad de la pandemia dentro del pa√≠s; a mayor n√∫mero de pruebas, mayor es la conciencia sobre la magnitud del problema, lo que a su vez puede incentivar tanto la acci√≥n gubernamental como la demanda de vacunas por parte de la poblaci√≥n.

2. `total_deaths` **(Total de Muertes Confirmadas)**: Esta es, quiz√°s, la variable m√°s directa para medir la percepci√≥n del riesgo y la urgencia a nivel social. Un n√∫mero elevado de muertes por COVID-19 impacta de forma contundente la conciencia p√∫blica, actuando como un poderoso motivador para que la poblaci√≥n busque activamente la vacunaci√≥n como medida de protecci√≥n. Adem√°s, la presi√≥n social y medi√°tica generada por altas tasas de mortalidad suele obligar a los gobiernos a acelerar y priorizar los programas de inmunizaci√≥n. Mide, en esencia, el costo humano de la pandemia, un factor determinante en la demanda de vacunas.

En conclusi√≥n, al combinar estas tres variables no solo cubrimos las pol√≠ticas p√∫blicas (stringency_index), la capacidad log√≠stica del sistema (total_tests) y la motivaci√≥n ciudadana (total_deaths), sino que creamos un modelo robusto. Este enfoque nos permite obtener una visi√≥n multifac√©tica y precisa de los factores que, en conjunto, explican las variaciones en la tasa de vacunaci√≥n entre diferentes poblaciones.
:::


```{r}
#| message: false
#| warning: false
library(dplyr)
# Filtrar los datos para seleccionar solo Colombia y las variables de inter√©s
nueva_base_datos <- datos %>%
  filter(location == "Colombia") %>%  # Seleccionar solo los datos de Colombia
  select(total_vaccinations_per_hundred, stringency_index,total_tests,total_deaths)  # Seleccionar las variables de inter√©s
 
# Ver las primeras filas de la nueva base de datos
(nueva_base_datos)

```

::: {.cell}
```{=html}
<iframe src="https://ourworldindata.org/explorers/covid?tab=map&zoomToSelection=true&facet=none&uniformYAxis=0&country=OWID_WRL~COL&pickerSort=asc&pickerMetric=entityName&hideControls=true&Metric=Vaccine+doses&Interval=7-day+rolling+average&Relative+to+population=true"
        loading="lazy"
        style="width: 100%; height: 600px; border: 0px none;"
        allow="web-share; clipboard-write">
</iframe>
```
:::

```{r}
#| message: false
#| warning: false
#| include: false
# Ver cu√°ntos NA hay en cada columna
na_por_variable <- colSums(is.na(nueva_base_datos))
 
# Mostrar los resultados ordenados de mayor a menor
na_por_variable[order(-na_por_variable)]
```

```{r}
#| message: false
#| warning: false
#| include: false
# Escalar la variable dependiente (evitando 0 y 1 exactos)
nueva_base_datos <- nueva_base_datos %>%
  mutate(total_vaccinations_scaled = (total_vaccinations_per_hundred + 0.0001) / (max(total_vaccinations_per_hundred, na.rm = TRUE) + 0.0002))
 
nueva_base_datos
```



```{r}
library(betareg)
modelo_beta<- betareg(total_vaccinations_scaled ~ stringency_index +  total_tests + total_deaths , data = nueva_base_datos)
 
# Ver resumen del modelo
summary(modelo_beta)

```

### F√≥rmula
$$
\text{logit}(\hat{\mu}_i) = \ln\left(\frac{\hat{\mu}_i}{1 - \hat{\mu}_i}\right) = \hat{\beta}_0 + \hat{\beta}_1 X_{1i} + \hat{\beta}_2 X_{2i} + \hat{\beta}_3 X_{3i}
$$

$$
\text{logit}(\widehat{\text{tasa de vacunaci√≥n}}) = -4.994 - 0.0212 \cdot (\text{stringency\_index}) + (2.343 \times 10^{-7}) \cdot (\text{total\_tests}) - (6.470 \times 10^{-7}) \cdot (\text{total\_deaths})
$$

::: {style="text-align: justify;"}
**Coeficientes (Modelo de la Media con Enlace Logit)**

Estos coeficientes te indican c√≥mo cada variable predictora influye en las probabilidades logar√≠tmicas (log-odds) de la tasa de vacunaci√≥n. Recuerda que, debido al enlace logit, estos no son cambios directos en la proporci√≥n en s√≠, sino cambios en las probabilidades logar√≠tmicas.

`Intercepto`: $-4.994e+00 (p<0.001)$

Este es el estimado de las probabilidades logar√≠tmicas de la tasa de vacunaci√≥n cuando `stringency_index`, `total_tests` y `total_deaths` son todos cero. Es altamente significativo estad√≠sticamente.

`stringency_index`: $-2.120e-02 (p=0.000174)$

Este coeficiente es negativo y altamente significativo estad√≠sticamente.

Interpretaci√≥n: Por cada aumento de una unidad en el stringency_index, las probabilidades logar√≠tmicas de la tasa de vacunaci√≥n se estiman que disminuyen en $0.0212$. Esto sugiere que medidas gubernamentales m√°s estrictas podr√≠an estar asociadas con tasas de vacunaci√≥n ligeramente m√°s bajas, manteniendo los dem√°s factores constantes.

`total_tests`: $2.343e-07 (p<2e‚àí16)$

Este coeficiente es positivo y extremadamente significativo estad√≠sticamente. ¬°Este es un efecto muy fuerte!

Interpretaci√≥n: Por cada total_test adicional realizado, las probabilidades logar√≠tmicas de la tasa de vacunaci√≥n se estiman que aumentan en $2.343e-07$. Aunque el n√∫mero en s√≠ es muy peque√±o, total_tests probablemente abarca un rango amplio, lo que significa que su impacto general puede ser sustancial. Esto tiene sentido intuitivamente: un mayor n√∫mero de pruebas podr√≠a indicar una respuesta de salud p√∫blica m√°s robusta, lo que podr√≠a llevar a una mayor adopci√≥n de la vacunaci√≥n.

`total_deaths`: $-6.470e-07 (p=0.877333)$

Este coeficiente no es estad√≠sticamente significativo $(p-valor = 0.877)$.

Interpretaci√≥n: Seg√∫n este modelo, no hay una relaci√≥n lineal estad√≠sticamente significativa entre total_deaths y las probabilidades logar√≠tmicas de la tasa de vacunaci√≥n al tener en cuenta el stringency_index y total_tests. No puedes concluir con confianza que total_deaths sea un predictor de las tasas de vacunaci√≥n en este modelo en particular.
:::

```{r}
#| message: false
#| warning: false
head(fitted(modelo_beta))
```

```{r}
#| message: false
#| warning: false
# Aseg√∫rate de tener ggplot2 cargado para una visualizaci√≥n efectiva
library(ggplot2)
 
# Obtener los valores ajustados (predicciones de probabilidad) de tu modelo
predicciones_probabilidad <- fitted(modelo_beta)
# Crear un dataframe para la gr√°fica
# Usamos un √≠ndice secuencial para el eje X, representando cada "individuo" u observaci√≥n
df_predicciones_lineales <- data.frame(
  Indice_Observacion = 1:length(predicciones_probabilidad),
  Probabilidad_Predicha = predicciones_probabilidad
)
 
# Crear el gr√°fico lineal
ggplot(df_predicciones_lineales, aes(x = Indice_Observacion, y = Probabilidad_Predicha)) +
  geom_line(color = "darkblue", alpha = 0.7) + # Conecta los puntos con una l√≠nea
  geom_point(color = "darkblue", size = 1.5, alpha = 0.8) + # A√±ade los puntos individuales
  labs(title = "Probabilidad de Vacunaci√≥n Predicha a lo Largo de las Observaciones",
       x = "√çndice de la Observaci√≥n(tiempo)",
       y = "Probabilidad Predicha de Vacunaci√≥n") +
  theme_minimal() +
  ylim(0, 1) # Asegura que el eje Y vaya de 0 a 1, ya que son probabilidades
```


# Discusi√≥n

Se interpretan y discuten los resultados. Es importante hacer una relaci√≥n con los objetivos iniciales.

Tambi√©n se deben comparar los resultados con estudios previos.

Se abordan las limitaciones del estudio y las posibles implicaciones para futuras investigacione

#  Conclusiones


# Referencias




